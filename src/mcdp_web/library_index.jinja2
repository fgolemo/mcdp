<!DOCTYPE html>
<html lang="en">
<head>
    <title>Library {{navigation['current_library']}}</title>
    {% include 'head.jinja2' %}
    <style>{% include 'library_index.css' %}</style>
    <script>{% include 'library_index.js' %}</script>
</head>
<body>
{% include 'refresh_shortcut.jinja2' %}

{% include 'model_views_navigation.jinja2' %}
{% set index_doc = navigation['current_library'] + '-index' %}

<div id='allcontents' style='visibility: hidden'>
{% if has_library_doc(index_doc) %}
	{{ render_library_doc(index_doc) | safe }}
{% else %}

<!--<p>Click &#9776; in the upper left and select "new" to add a new model.</p>-->

<div id='outside'>
<table align='center' id='library-contents'>
<thead>
<tr><td id='ttitle' colspan="5">
    {{icon_shelf|safe}}&nbsp;<a href="{{root}}/shelves/{{navigation.shelfname}}/">{{navigation.shelfname}}</a> /
    {{icon_library|safe}}&nbsp;<code>{{navigation.current_library}}</code>
</td></tr>
<tr id="things">
	<td>MCDPs</td>
	<td>Templates</td>
	<td>Posets</td>
	<td>Values</td>
	{% if navigation['documents'] %}
	<td>Documents</td>
	{% endif %}
</tr></thead>

<tbody>
<tr>
	{% for what in ["models","templates","posets","values","documents"] %}
	<!-- only put the documents if they exist -->
	{% if what != 'documents' or navigation[what] %}
<td>
	{% if not navigation[what] %}
	<p class='none-available'>(none)</p><br/>
	{% endif %}

	{% for d in navigation[what] %}
		<p class='entry'>
		{% if 'url_edit' in d and shelf_can_write(navigation.shelf_name)%}
            <a class='url_edit' href="{{d['url_edit']}}">✎</a>
            <a class='url_edit' href="{{d['url_delete']}}">♻</a>
          {% endif %}
            <code><a class="url" href="{{d['url']}}">{{icon_spec(what)|safe}}&nbsp;{{d['id']}}</a></code>
		</p>
	{% endfor %}

</td>
	{% endif %}
	{% endfor %}

</tr>
<tr>
    {% for what in ["models","templates","posets","values","documents"] %}
    {% if what != 'documents' or navigation[what] %}
    <td class='plus'>
    {% if what != 'documents' %}
	{% if shelf_can_write(navigation.shelf_name) %}
        <button id="table_new_{{what}}">+</button>{% endif %}
	{% endif %}
    </td>
    {% endif %}
    {% endfor %}
</tr>

</tbody>

</table>

<div id='extra_commands'>
{% if not shelf_can_write(navigation.shelf_name) %}
    <p> This library is read-only for this user. </p>
{%endif%}

{% if navigation['models'] %}
    <p><button id='show_previews'>Show MCDP previews</button></p>
{% endif %}
</div>

</div>



<div id='previews' style='display: none;'>
{% for m in navigation['models'] %}

<a class='modellink' href="{{m['url']}}">
<div id='{{ m["id"] }}-div' class="compact">
	<span class="name">
		<code>{{ m['id'] }}</code>
	</span>

	<img id='{{ m["id_ndp"] }}-image' src='{{root}}/static/white_small.png'/>

	<script type='text/javascript'>
		tmp_img="{{root}}/libraries/{{navigation['current_library']}}/models/{{m['id_ndp']}}/views/images/ndp_graph_templatized.png";
		tmp_target = '#{{ m["id_ndp"] }}-image';
		all_images.push([tmp_img, tmp_target]);

	function {{ m["id_ndp"] }}_callback() {
		src = "{{root}}/libraries/{{navigation['current_library']}}/models/{{m['id_ndp']}}/views/images/ndp_graph_templatized.png";

		which = '#{{ m["id_ndp"] }}-image';

		$(which).prop('src', src);
	}

	$(document).ready(function() {
		$( '#{{ m["id_ndp"] }}-div' ).hover({{ m["id_ndp"] }}_callback);
	});

	</script>


</div>
</a>
{% endfor %}
</div>
{%endif%}

 </div>

{% include 'footer.jinja2' %}
</body>
</html>
